{"version":3,"sources":["main.js"],"names":["Site","init","_this","this","Utilities","Header","Search","Support","Analytics","$","document","ready","Gallery","bind","fixWidows","displayTimeSince","checkGDPRApproval","length","bindResourcesToggle","click","selectText","$resources","toggle","each","string","html","replace","$element","timestamp","data","m","moment","isAfter","subtract","text","fromNow","approvalCookie","Cookies","get","show","set","hide","$menuToggle","$headerSub","$searchToggle","$headerSearch","$searchInput","hasClass","showSinglePostTitle","focus","headerHeight","height","$headerSinglePostTitle","setSinglePostTitleWidth","window","scroll","scrollTop","css","resize","totalWidth","innerWidth","navsWidth","galleryInstances","initSwiperInstances","index","item","Swiper","loop","pagination","paginationType","paginationFractionRender","swiper","currentClassName","totalClassName","onTap","event","slideNext","fourzerofour","href","location","request","split","pop","val","$progressBar","initProgressBar","on","target","closest","find","value","textStatus","percent","slideDown","displayProgressText","total","numberWithCommas","Math","round","x","toString","dataLayer","debounce","push","amount","func","wait","immediate","timeout","context","args","arguments","later","apply","callNow","clearTimeout","setTimeout"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, Site, Cookies, dataLayer, Swiper, moment */\n\nSite = {\n  init: function() {\n    var _this = this;\n\n    _this.Utilities.init();\n    _this.Header.init();\n    _this.Search.init();\n    _this.Support.init();\n    _this.Analytics.init();\n\n    $(document).ready(function() {\n      _this.Gallery.init();\n    });\n  }\n};\n\nSite.Utilities = {\n  init: function() {\n    var _this = this;\n\n    _this.bind();\n    _this.fixWidows();\n    _this.displayTimeSince();\n    _this.checkGDPRApproval();\n  },\n\n  bind: function() {\n    var _this = this;\n\n    if ($('#single-resources-section').length) {\n      _this.bindResourcesToggle();\n    }\n\n    $('.js-select').click(function() {\n      $(this).selectText();\n    });\n\n  },\n\n  bindResourcesToggle: function() {\n    var $resources = $('#single-resources-section');\n\n    $('#js-resources-toggle').click(function() {\n      $resources.toggle();\n    });\n\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n\n  displayTimeSince: function() {\n    $('.js-time-since').each(function() {\n      var $element = $(this);\n      var timestamp = $element.data('timestamp');\n      var m = moment(timestamp);\n\n      if (m.isAfter(moment().subtract(5, 'hours'))) {\n        $element.text('| ' + m.fromNow());\n      }\n    });\n  },\n\n  checkGDPRApproval: function() {\n    var approvalCookie = Cookies.get('gdpr-approval');\n\n    if (approvalCookie !== 'true') {\n      $('#gdpr').show();\n\n      $('#gdpr-accept').click(function() {\n        Cookies.set('gdpr-approval', true);\n        $('#gdpr').hide();\n      });\n    }\n  }\n\n};\n\nSite.Header = {\n  init: function() {\n    var _this = this;\n\n    _this.$menuToggle = $('#menu-toggle');\n    _this.$headerSub = $('#header-sub');\n    _this.$searchToggle = $('#search-toggle');\n    _this.$headerSearch = $('#header-search');\n    _this.$searchInput = $('#search-input');\n\n    _this.bind();\n\n    if ($('body').hasClass('single')) {\n      _this.showSinglePostTitle();\n    }\n\n  },\n\n  bind: function() {\n    var _this = this;\n\n    _this.$menuToggle.click(function() {\n      _this.$headerSub.toggle();\n    });\n\n    _this.$searchToggle.click(function() {\n      _this.$headerSearch.toggle();\n       _this.$searchInput.focus();\n    });\n\n  },\n\n  showSinglePostTitle: function() {\n    var _this = this;\n\n    _this.headerHeight = $('#header-main-wrapper').height();\n    _this.$headerSinglePostTitle = $('#header-page-title');\n\n    _this.setSinglePostTitleWidth();\n\n    $(window).scroll(function() {\n      if ($(window).scrollTop() > _this.headerHeight) {\n\n        _this.$headerSinglePostTitle.css('opacity', 1);\n\n      } else {\n\n        _this.$headerSinglePostTitle.css('opacity', 0);\n\n      }\n    });\n\n    $(window).resize(function() {\n      _this.setSinglePostTitleWidth();\n    });\n\n  },\n\n  setSinglePostTitleWidth: function() {\n    var _this = this;\n\n    totalWidth = $('.col18').innerWidth();\n    navsWidth = $('#header-navs').innerWidth();\n\n    _this.$headerSinglePostTitle.css('max-width', (totalWidth - navsWidth - 10) + 'px');\n  }\n};\n\nSite.Gallery = {\n  galleryInstances: [],\n\n  init: function() {\n    var _this = this;\n\n    if ($('.swiper-container').length) {\n      _this.initSwiperInstances();\n    }\n  },\n\n  initSwiperInstances: function() {\n    var _this = this;\n\n    $('.swiper-container').each(function(index, item) {\n\n      _this.galleryInstances[index] = new Swiper(item, {\n        loop: true,\n        pagination: '#gallery-pagination',\n        paginationType: 'fraction',\n        paginationFractionRender: function (swiper, currentClassName, totalClassName) {\n          return '<span class=\"' + currentClassName + '\"></span>/<span class=\"' + totalClassName + '\"></span>';\n        },\n        onTap: function(swiper, event) {\n          swiper.slideNext();\n        },\n      });\n    });\n  }\n};\n\nSite.Search = {\n  init: function() {\n    var _this = this;\n\n     if ($('body').hasClass('error404')) {\n      _this.fourzerofour();\n    }\n\n  },\n\n  fourzerofour: function() {\n    var href = window.location.href;\n    // remove url before WP\n    var request = href.split('/');\n    // get last part of url\n\n    // If trailing /\n    if( request[request.length - 1] === \"\" ) {\n      // Remove last element from the array\n      request.pop();\n    }\n\n    request = request[request.length-1];\n    // remove any dashes [in the case of a real permalink slug]\n    request = request.replace(/-/g, ' ');\n\n    if (request) {\n      $('#search-input').val(request).focus();\n    }\n  },\n};\n\nSite.Support = {\n  init: function() {\n    var _this = this;\n\n    if ($('.support-section').length) {\n      _this.bind();\n    }\n\n    _this.$progressBar = $('#progress-bar');\n\n    if (_this.$progressBar.length) {\n      _this.initProgressBar();\n    }\n  },\n\n  bind: function() {\n    $('.support-form-slider').on('input', function() {\n      var target = $(this).closest('.support-form').find('.support-form-value');\n      target.html(this.value);\n    });\n  },\n\n  initProgressBar: function() {\n    var _this = this;\n\n    _this.$progressBar.css('width', '0%');\n\n    $.get('https://payment.novaramedia.com/api/goal', null, function(data, textStatus) {\n\n      if (textStatus === 'success') {\n        var percent = data.percent;\n\n        if (percent > 1) {\n          percent = 1;\n        }\n\n        $('#progress-bar-row').slideDown(1250, function() {\n          _this.$progressBar.css('width', (percent * 100) + '%');\n\n          _this.displayProgressText(data);\n        });\n      }\n\n    }, 'json');\n  },\n\n  displayProgressText: function(data) {\n    var _this = this;\n\n    var total = data.total / data.percent;\n    var text = ': £' + _this.numberWithCommas(data.total) + ' of £' + _this.numberWithCommas(Math.round(total));\n\n    $('#progress-text').text(text);\n  },\n\n  numberWithCommas: function(x) {\n    // https://stackoverflow.com/questions/2901102/how-to-print-a-number-with-commas-as-thousands-separators-in-javascript#2901298\n    return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n  },\n};\n\nSite.Analytics = {\n  init: function() {\n    var _this = this;\n\n    if (dataLayer) {\n      _this.bind();\n    }\n  },\n\n  bind: function() {\n    var _this = this;\n\n    $('.support-form-slider').on('input', _this.debounce(function() {\n      dataLayer.push({\n       'event': 'sliderChanged',\n       'target': $(this).data('target'),\n       'amount': this.value,\n      });\n    }, 250));\n\n    Site.Header.$menuToggle.click(function() { // bind hamburger click\n      dataLayer.push({\n       'event': 'headerToggled'\n       });\n    });\n\n    $('.related-posts .post').click(function() {\n      dataLayer.push({\n       'event': 'relatedPostClicked'\n       });\n    });\n\n  },\n\n  debounce: function(func, wait, immediate) {\n  \tvar timeout;\n  \treturn function() {\n  \t\tvar context = this, args = arguments;\n  \t\tvar later = function() {\n  \t\t\ttimeout = null;\n  \t\t\tif (!immediate) func.apply(context, args);\n  \t\t};\n  \t\tvar callNow = immediate && !timeout;\n  \t\tclearTimeout(timeout);\n  \t\ttimeout = setTimeout(later, wait);\n  \t\tif (callNow) func.apply(context, args);\n  \t};\n  },\n};\n\nSite.init();"],"sourceRoot":"/source/"}